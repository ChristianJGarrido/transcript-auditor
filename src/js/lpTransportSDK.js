window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.lpajax_utils={_name:"lpajax_utils",_v:"0.1",each:function(a,b,c){if(null!=a){var d=Array.prototype.forEach;if(d&&a.forEach===d)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)==={})return}else for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)&&b.call(c,a[g],g,a)==={})return}},extend:function(a){this.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]});return a},isEmptyObj:function(a){for(var b in a)return!1;return!0},init:function(){}};window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.lpAjax=lpTag.taglets.lpAjax||function(a){function b(){p=!0}function c(b,c){a.lpTag&&lpTag.log&&lpTag.log(b,c,m)}function d(a,b){if(o[a])c("Existing transport: "+a+" tried to register",q.DEBUG);else{o[a]=b;c("Added transport: "+a,q.DEBUG)}}function e(a){p||b();var d="unknown";try{var e=h(a);if(e){e.issueCall(a);return!0}c("No Transport found to issueCall",q.ERROR);k(q.ERROR,a.error,{responseCode:601,error:"No Transport found to issueCall, request: "+a.url,body:"ERROR"},a.context)}catch(f){e&&e.getName&&(d=e.getName());c("Transport - "+d+" - unknown exception while issueCall",q.ERROR);k(q.ERROR,a.error,{responseCode:600,error:"Transport - "+d+" - unknown exception while issueCall: "+a.url+" e="+f,body:"ERROR"},a.context)}}function f(a){p||b();for(var c in a){var d=o[c];d&&d.configure(a[c])}}function g(a){if(a&&"object"==typeof a){a.appName=n;a.ts=(new Date).getTime();a.tags&&a.tags.constructor===Array&&a.tags.push({pageId:r});c(a,q.METRICS)}}function h(a){for(var b,c=!1,d=-1,e=0;e<a.transportOrder.length;e++)if(!c){b=j({},a);var f=o[b.transportOrder[e]];if(f&&f.isValidRequest&&f.isValidRequest(b)){c=!0;d=e}}return c?o[b.transportOrder[d]]:null}function i(a,b,c){if(null!=a){var d=Array.prototype.forEach;if(d&&a.forEach===d)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)==={})return}else for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)&&b.call(c,a[g],g,a)==={})return}}function j(a){i(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]});return a}function k(a,b,d,e){if("function"==typeof b)try{b.call(e||null,d);b=null}catch(f){c("runCallback: Exception in execution of callback, type :"+a+" e=["+f.message+"]",q.ERROR)}else c("runCallBack: No callback, of type :"+a,q.INFO)}var l="1.1.3",m="lpAjax",n="lpTransporter",o={},p=!1,q={ERROR:"ERROR",DEBUG:"DEBUG",INFO:"INFO",METRICS:"METRICS"},r="lpT"+Math.floor(1e5*Math.random())+"_"+Math.floor(1e6*Math.random());return{getVersion:function(){return l},getName:function(){return m},init:b,publishMetrics:g,issueCall:e,configureTransports:f,addTransport:d}}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.jsonp=lpTag.taglets.jsonp||function(a){function b(){if(lpTag&&lpTag.taglets&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(W,X)}catch(a){}x()}function c(a){if(a)for(var c in a)H.hasOwnProperty(c)&&a.hasOwnProperty(c)&&(H[c]=a[c]);b()}function d(b){var c=!1;if(J&&b&&b.url){var d=!1;b.callbackName&&"string"==typeof b.callbackName&&(T[b.callbackName]||a[b.callbackName])&&(d=!0);var e;try{e=k(b)}catch(f){E("Could not evaluate the length  of the request, e="+f,I.ERROR,"isValidRequest");c=!1}"undefined"!=typeof e&&e<K&&!d&&(c=!0)}return c}function e(a){var b;if(!d(a)){E("URL request was too long or static callback name already exists, url: "+b,I.ERROR,"issueCall");s();a&&a.error&&B(I.ERROR,a.error,i(600,"Transport - JSONP - unable to run request: "+a.url),a.context);return!1}a=g(a);a.callbackName&&"string"==typeof a.callbackName?a.retries=0:a.callbackName=L+h();b=a.url+(a.url.indexOf("?")>-1?"&":"?")+a.callback+"="+a.callbackName;a.data&&(b+="&"+l(a.data));a.query&&(b+="&"+l(a.query));a.callUrl=b;if(n(a)){D(a);o()}else E("URL request was too long and was not sent, url: "+b,I.ERROR,"issueCall");return!0}function f(){var a={};for(var b in H)H.hasOwnProperty(b)&&(a[b]=H[b]);return a}function g(a){if("string"==typeof a){var b=a;a={url:b}}if(!a.url)return!1;a.encoding=a.encoding||H.encoding;a.callback=a.callback||H.callback;a.retries="number"==typeof a.retries?a.retries:H.retries;a.timeout=a.timeout?a.timeout:H.timeout;return a}function h(a){var b,c=99999,d="x";b=a?c+d+c:Math.round(Math.random()*c)+d+Math.round(Math.random()*c);return b}function i(a,b){return{statusCode:a,responseCode:a,error:b,body:"ERROR"}}function j(){return"scr"+Math.round(999999999*Math.random())+"_"+Math.round(999999999*Math.random())}function k(a){var b=U;a.callbackName&&"string"==typeof a.callbackName&&(b=a.callbackName.length);return 4+(a.callback||H.callback).length+a.url.length+b+l(a.data).length+l(a.query).length}function l(a){var b="";if("string"==typeof a)b+=a;else{var c=!0;for(var d in a){var e;"object"==typeof a[d]?e=m(a[d]):"function"!=typeof a[d]&&(e=a[d]);if("undefined"!=typeof e){c||(b+="&");b+=encodeURIComponent(d)+"="+encodeURIComponent(e);c=!1}}}return b}function m(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function n(b){var c,d=!1,e=new RegExp(/(http{1}s{0,1}?:\/\/)([^\/\?]+)(\/?)/gi);c=0===b.callUrl.indexOf("http")?e.exec(b.callUrl):e.exec(a.location.href);if(c&&c.length>=3&&""!==c[2]){var f=c[2].toLowerCase();b.domainMatch=f;M[f]=M[f]||[];M[f].inFlight=M[f].inFlight||0;M[f].push(b);d=!0;O+=1;E("buffered URL: "+b.callUrl,I.DEBUG,"lpTag.taglets.jsonp.bufferRequest")}else E("NO MATCH for URL: "+b.callUrl,I.ERROR,"lpTag.taglets.jsonp.bufferRequest");return d}function o(){var a;for(var b in M)if(M.hasOwnProperty(b)){a=M[b];for(var c=!1;!c&&a.inFlight<6&&a.length>0;){var d=a.shift();if(d){E("Sent URL: "+d.callUrl,I.DEBUG,"lpTag.taglets.jsonp.sendRequests");d.scriptId=q(d.callUrl,d.encoding,d.callbackName);d.startTime=(new Date).getTime();r(b,d.callbackName,d.timeout);O-=1}else c=!0}}a=null}function p(){clearTimeout(F);F=null;var b=new Date;for(var c in T)if(T.hasOwnProperty(c)&&T[c].launchTime){var d=b-T[c].launchTime;(T[c].loadTime||d>T[c].timeout)&&a[c].apply(null,[i(408,{message:"Request timed out",name:"timeout"}),!0])}P>0&&(F=setTimeout(p,1e3))}function q(b,c,d){var e=j(),f=document.createElement("script");f.setAttribute("type","text/javascript");f.setAttribute("charset",c);f.onload=function(){T[d]&&(T[d].loadTime=new Date);this.onload=this.onerror=this.onreadystatechange=null};a.addEventListener?f.onerror=function(){T[d]&&(T[d].loadTime=new Date);this.onload=this.onerror=this.onreadystatechange=null}:f.onreadystatechange=function(){if(this.readyState&&("loaded"===this.readyState||"complete"===this.readyState)){T[d]&&(T[d].loadTime=new Date);this.onload=this.onerror=this.onreadystatechange=null}};f.setAttribute("src",b);f.setAttribute("id",e);document.getElementsByTagName("head")[0].appendChild(f);F||(F=setTimeout(p,1e3));f=null;return e}function r(a,b,c){M[a].inFlight=M[a].inFlight+1;T[b]={launchTime:new Date,timeout:c};P+=1;N+=1}function s(){Q+=1}function t(a){var b=document.getElementById(a);if(b)try{b.parentNode.removeChild(b);for(var c in b)b.hasOwnProperty(c)&&delete b[c]}catch(d){E("error when removing script",I.ERROR,"removeScript")}}function u(a){M[a].inFlight=M[a].inFlight-1;P-=1}function v(a,b,c){y(b.startTime,b.url,c);t(b.scriptId);u(b.domainMatch);C(b.callbackName,c);if(c){if(b.callbackName){b.callbackName=null;delete b.callbackName}z(a,b)}else{A(b);B("callback",b.success,a,b.context);b=null;o()}}function w(){var a;if(lpTag.taglets.lpAjax&&lpTag.taglets.lpAjax.publishMetrics&&S.length>0){a={tags:[{transport:W}],metrics:S};lpTag.taglets.lpAjax.publishMetrics(a);S.length=0}x()}function x(){G&&clearTimeout(G);G=setTimeout(w,H.metricsTimeout)}function y(a,b,c){var d,e;if(a){e=(new Date).getTime();d=e-a;S.push({rd:d,ts:a,url:b,method:"GET",statusCode:c?400:200});S.length>=H.metricsCount&&w()}}function z(a,b){R+=1;if(b.retries>0){b.retries=b.retries-1;e(b)}else{A(b);B(I.ERROR,b.error,a||i(408,{id:408,name:"TIMEOUT",message:"Request has timed out on all retries"}),b.context);b=null;o()}}function A(a){for(var b=["callUrl","retries","id","requestTimeout","type","encoding","launchTime","callbackName","domainMatch","startTime"],c=0;c<b.length;c++)if(a.hasOwnProperty(b[c])){a[b[c]]=null;delete a[b[c]]}}function B(a,b,c,d){if("function"==typeof b)try{b.call(d||null,c);b=null}catch(e){E("Exception in execution of callback, type :"+a+" e=["+e.message+"]",I.ERROR,"runCallback")}else E("No callback, of type :"+a,I.INFO,"runCallback")}function C(b,c){T[b]=null;delete T[b];if(c===!0)a[b]=function(){a[b]=null;try{delete a[b]}catch(c){}};else{a[b]=null;try{delete a[b]}catch(d){}}}function D(b){if(T[b.callbackName]){s();z(i(409,{message:"This callbackName is already in a pending request and can't be serviced",id:409,name:"CONFLICT"}),b)}else a[b.callbackName]=function(a,c){v(a,b,c)}}function E(b,c,d){if(a.lpTag&&lpTag.log){"string"==typeof b&&d&&(b=d+": "+b);lpTag.log(b,c,W)}}var F,G,H={callback:"cb",encoding:"UTF-8",timeout:1e4,retries:2,metricsCount:100,metricsTimeout:6e4},I={ERROR:"ERROR",DEBUG:"DEBUG",INFO:"INFO"},J=!0,K=2083,L="lpCb",M={},N=0,O=0,P=0,Q=0,R=0,S=[],T={},U=h(!0).length,V="1.1.7",W="jsonp",X={init:b,configure:c,issueCall:e,isValidRequest:d,getVersion:function(){return V},getName:function(){return W},getDefaults:f,inspect:function(){return{name:W,version:V,callsMade:N,errorsFound:R,pending:P,buffered:O,refused:Q,defaults:f()}}};b();return X}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.postmessage=lpTag.taglets.postmessage||function(a){function b(a){var b=0===location.protocol.indexOf("https");if(a){if(a.frames){a.frames=a.frames.constructor===Array?a.frames:[a.frames];for(var c=0;c<a.frames.length;c++)o(a.frames[c],b)}if(a.defaults)for(var d in a.defaults)sa.hasOwnProperty(d)&&a.defaults.hasOwnProperty(d)&&(sa[d]=a.defaults[d])}ca=!0}function c(){if(lpTag&&lpTag.taglets&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(ba,va)}catch(a){}}function d(b){var c=!1;if(a.postMessage&&a.JSON&&b&&b.success&&(b.domain&&b.validation||b.url)){b.domain=b.domain||n(b.url);(da[b.domain]||ja[b.domain])&&(c=!0)}return c}function e(a){var b=!1;if(ca&&d(a))if(da[a.domain])if(da[a.domain].validated!==ua.PENDING||a.validation){b=I(a);b?u(a.domain):ea[a.callId].timeout=0}else b=v(a.domain,a);else{Z("Adding iFrame to DOM - first request: "+a.domain,ma.INFO,"issueCall");b=v(a.domain,a);p(ja[a.domain]);delete ja[a.domain]}else b=H(a.domain,a.error,a.context);return b}function f(a){return a&&da[a]?{url:da[a].url,validated:da[a].validated,requestCount:da[a].requestCount,defaults:N(da[a].defaults),started:da[a].validated===ua.VALIDATED}:{}}function g(){var a={};for(var b in da)da.hasOwnProperty(b)&&(a[b]=f(b));return a}function h(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function i(a,b){return{callId:a,responseType:b.responseType,responseCode:b.responseCode,error:{message:b.message,id:b.responseCode,name:b.name}}}function j(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}function k(){if(document.body){ka=!0;l()}else setTimeout(k,5)}function l(){for(;la.length>0;)try{la.shift().call(null)}catch(a){Z("Unable to execute queued callbacks for window interactive state: "+a,ma.ERROR,"_attachPendingIFrames")}}function m(a){return a+"_"+Math.floor(1e5*Math.random())+"_"+Math.floor(1e5*Math.random())}function n(a){var b,c=new RegExp(/(http{1}s{0,1}?:\/\/)([^\/\?]+)(\/?)/gi),d=null;if(0!==a.indexOf("http"))return location.protocol+"//"+location.host;b=c.exec(a);b&&b.length>=3&&""!==b[2]&&(d=b[1].toLowerCase()+b[2].toLowerCase());return d}function o(a,b){var c,d,e=!1;if(!a||!a.url||"string"!=typeof a.url){Z("iFrame configuration empty or missing url parameter",ma.ERROR,"_queueFrame");return e}c=n(a.url);d=0===a.url.toLowerCase().indexOf("https");if(!(da[c]||ja[c]||b&&d!==b)){ja[c]=a;e=!0}return e}function p(a){var b=n(a.url);if(da[b])return w(b,a.callback||a.success,a.context);var c=m("fr");da[b]={elem:x(c),url:a.url,validated:ua.PENDING,defaults:a.defaults||{},delayLoad:isNaN(a.delayLoad)?0:a.delayLoad,requestCount:0,success:a.callback||a.success,error:a.error,maxReloadRetries:a.maxReloadRetries||3,reloadInterval:1e3*a.reloadInterval||3e4};setTimeout(function(){r(a.url,b)},da[b].delayLoad);Z("iFrame Queued to load "+b,ma.INFO,"_addFrame");return ua.PENDING}function q(a){var b=n(a.url);ja[b]={url:a.url,defaults:a.defaults||{},delayLoad:a.delayLoad,success:a.success,error:a.error,maxReloadRetries:a.maxReloadRetries,reloadInterval:a.reloadInterval/1e3}}function r(a,b){ka?s(a,b):la.push(function(){s(a,b)})}function s(a,b){da[b].loadCallback=da[b].loadCallback||t(b);S(da[b].elem,a);h(da[b].elem,"load",da[b].loadCallback);da[b].iFrameOnloadTimeout=setTimeout(da[b].loadCallback,ta);da[b].attachTime=(new Date).getTime();document.body.appendChild(da[b].elem)}function t(a){return function(b){if(da[a].iFrameOnloadTimeout){clearTimeout(da[a].iFrameOnloadTimeout);delete da[a].iFrameOnloadTimeout}da[a].loadTime=(new Date).getTime()-da[a].attachTime;A(a,b)}}function u(a){ga+=1;ia+=1;da[a].requestCount=da[a].requestCount+1}function v(a,b){fa[a]=fa[a]||[];fa[a].push(b);return!0}function w(a,b,c){var d=f(a);W(b,c,d);return da[a].validated}function x(a){var b=document.createElement("IFRAME");b.setAttribute("id",a);b.setAttribute("name",a);b.setAttribute("tabindex","-1");b.setAttribute("aria-hidden","true");b.setAttribute("title","");b.setAttribute("role","presentation");b.style.width="0px";b.style.height="0px";b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";return b}function y(a,b,c,d,e,f){var g=!1;if(a&&b&&"function"==typeof b){ea[a]={success:b,error:c,progress:d,ctx:e,launchTime:new Date,timeout:isNaN(f)?sa.timeout:f+1e3};g=!0}return g}function z(a){if(ea[a]){ea[a]=null;delete ea[a];return!0}return!1}function A(a,b){Z("onLoad validation called "+a,ma.INFO,"_validateFrame");var c=function(b){B(b,a)};b&&b.error?B(b,a):setTimeout(function(){e({domain:a,success:c,error:c,validation:!0,timeout:100,retries:-1,defaults:da[a].defaults})},10);return!0}function B(a,b){var c,d=da[b];Z("running validation of domain "+b,ma.INFO,"_validateFrameCallback");if(d){da[b].validated=a&&a.error?ua.FAILED:ua.VALIDATED;c=da[b].validated===ua.VALIDATED;c?C(b,a):da[b].reloadObj&&da[b].reloadObj.retriesLeft>0?E(b):D(b)}d=null;return c}function C(a,b){var c;Z("FrameLoaded "+a,ma.INFO,"_runFrameValidated");c=N(qa);for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);W(da[a].success,da[a].context,c);U(a);F(a,!0)}function D(a){Z("iFrame is a teapot "+a,ma.ERROR,"_runFrameFailedToLoad");if(da[a].error){var b=i(0,ra);b.domain=a;W(da[a].error,da[a].context,b)}G(a);F(a,!1)}function E(a){Z("Retry loading domain: "+a,"info","_runReloadAttempt");F(a,!1);P(a)}function F(a,b){Z("Running buffer queue : "+a+" loaded: "+b,ma.INFO,"_runQueuedRequests");if(fa[a]&&fa[a].length>0){do{var c=fa[a].shift();b?e(c):W(c.error,c.context,{responseCode:600,error:"Transport - postmessage - unable to run request: "+a,body:"ERROR"})}while(fa[a].length>0);fa[a]=null;delete fa[a]}}function G(a){Z("Cleaning up failed iFrame: "+a,ma.INFO,"_cleanupIFrame");if(da[a]){j(da[a].elem,"load",da[a].loadCallback);da[a].elem.parentNode.removeChild(da[a].elem);var b=N(ra);b.domain=a;b.url=da[a].url;W(da[a].error,da[a].context,b);q(da[a]);da[a]=null;delete da[a]}}function H(a,b,c){Z("Frame not found for domain: "+a,ma.ERROR,"_noFrameFound");W(b,{responseCode:600,error:"Transport - postmessage - unable to run request: "+a,body:"ERROR"},c);return!1}function I(a){var b,c=!1;a=K(a);b=N(a);try{b=J(b)}catch(d){Z("Error trying to _stringify message",ma.ERROR,"sendMessageToFrame");return!1}Z("sending msg to domain "+a.domain,ma.DEBUG,"sendMessageToFrame");var e;isNaN(a.timeout)||isNaN(a.retries)||(e=a.timeout*(a.retries+1)+2e3);y(a.callId,a.success,a.error,a.progress,a.context,e);try{c=L(a.domain,b);_=setTimeout(M,1e3)}catch(d){Z("Error trying to send message: "+d,ma.ERROR,"sendMessageToFrame");c=!1}return c}function J(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function K(b){var c=da[b.domain]&&da[b.domain].defaults;b.callId=m("call");b.returnDomain=na;"undefined"==typeof b.timeout&&(b.timeout=c&&c.timeout||sa.timeout);"undefined"==typeof b.retries&&(b.retries=c&&"undefined"!=typeof c.retries?c.retries:sa.retries);b.progress&&(b.fireProgress=!0);b.headers=b.headers||{};b.headers["LP-URL"]=a.location.href;return b}function L(a,b){var c=!1;try{da[a].elem.contentWindow.postMessage(b,a);c=!0}catch(d){Z("Error trying to send message: "+d,ma.ERROR,"_postTheMessage")}return c}function M(){_&&clearTimeout(_);_=null;var a=new Date,b=0,c=[];for(var d in ea)if(ea.hasOwnProperty(d)&&ea[d].launchTime){var e=a-ea[d].launchTime;e>ea[d].timeout?c.push(d):b+=1}if(c.length){Z("Checking errors found "+c.length+" timeout callbacks to call",ma.DEBUG,"_checkForErrors");for(var f=0;f<c.length;f++)O(i(c[f],pa))}b>0&&(_=setTimeout(M,1e3));return!0}function N(a){var b=a;try{b=JSON.parse(J(a))}catch(c){}return b}function O(a,b){var c,d=ea[a.callId],e=a.responseType,f=!1;if(a.callId&&ea[a.callId]||a.responseType===oa.reloading||a.responseType===oa.stats)try{switch(e){case oa.completed:c=d.success;f=!0;break;case oa.error:c=d.error;f=!0;ha+=1;break;case oa.progress:c=d.progress;break;case oa.reloading:a=b;c=P;break;case oa.stats:c=$;a=a.rawData}if(f){z(a.callId);V(a);ia=ia>=0?0:ia-1}c&&"function"==typeof c&&W(c,d&&d.ctx||null,a);c=null;d=null}catch(g){Z("Error in executing callback: "+g,ma.ERROR,"_executeMessageCallback");return!1}return!0}function P(a){Z("Got reload request from "+a,ma.INFO,"_handleReload");da[a].validated=ua.PENDING;if(!da[a].reloadObj){Z("Creating reloadObj"+a,ma.DEBUG,"_handleReload");da[a].reloadObj=T(a)}Q(a)}function Q(a){Z("Reload try for domain "+a+" ,retries left "+da[a].reloadObj.retriesLeft,ma.INFO,"_reloadIFrame");da[a].reloadObj.retriesLeft=da[a].reloadObj.retriesLeft-1;da[a].reloadObj.setLocationTimeout&&clearTimeout(da[a].reloadObj.setLocationTimeout);if(da[a].reloadObj.retry)da[a].reloadObj.setLocationTimeout=setTimeout(R(a),da[a].reloadInterval);else{da[a].reloadObj.retry=!0;R(a)()}}function R(a){return function(){da[a].iFrameOnloadTimeout=setTimeout(function(){A(a,{error:{code:404,message:"Frame did not trigger load"}})},ta);S(da[a].elem,da[a].url)}}function S(a,b){b+=b.indexOf("?")>0?"&bust=":"?bust=";b+=(new Date).getTime();b+="&loc="+location.protocol+"//"+location.host;Z("Setting iFrame to URL: "+b,ma.INFO,"_setIFrameLocation");a.setAttribute("src",b)}function T(a){Z("Creating reload object "+a,ma.INFO,"_createReloadObject");var b=da[a].maxReloadRetries;return{retriesLeft:b}}function U(a){Z("Cleaning up reload object for this instance"+a,ma.INFO,"_cleanUpReloadObject");if(da[a].reloadObj){da[a].reloadObj.setLocationTimeout&&clearTimeout(da[a].reloadObj.setLocationTimeout);da[a].reloadObj=null;delete da[a].reloadObj}}function V(a){for(var b=["callId","responseType"],c=0;c<b.length;c++){a[b[c]]=null;delete a[b[c]]}}function W(a,b,c){if(a&&"function"==typeof a)try{a.call(b||null,c)}catch(d){Z("Error in executing callback: "+d,ma.ERROR,"runCallback")}}function X(a){var b,c;try{c=a.origin;if(!da[c])return;b=Y(a.data);b.body=Y(b.body)}catch(d){b=null;Z("Error in handling message from frame:"+d+" origin: "+c,ma.ERROR,"_handleMessage")}b&&"object"==typeof b&&O(b,c)}function Y(a){var b=a;if("string"==typeof a)try{b=JSON.parse(a)}catch(c){Z("Error in parsing string: "+a,ma.DEBUG,"_parseJSONString")}return b}function Z(b,c,d){if(a.lpTag&&lpTag.log){"string"==typeof b&&d&&(b=d+": "+b);lpTag.log(b,c,ba)}}function $(a){if(lpTag.taglets.lpAjax&&lpTag.taglets.lpAjax.publishMetrics){a.tags&&a.tags.constructor===Array&&a.tags.push({transport:ba});lpTag.taglets.lpAjax.publishMetrics(a)}}var _,aa="1.1.8",ba="postmessage",ca=!0,da={},ea={},fa={},ga=0,ha=0,ia=0,ja={},ka=!1,la=[],ma={DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR"},na=n(document.location.href),oa={progress:"progressLoad",completed:"completeLoad",success:"success",error:"errorLoad",reloading:"reloading",stats:"statData"},pa={responseType:oa.error,responseCode:404,message:"Request timed out on parent postMessage layer",name:"TIMEOUT"},qa={responseType:oa.success,responseCode:200,message:"iFrame has successfully loaded",name:"OK"},ra={responseType:oa.error,responseCode:418,message:"This iFrame is a teapot, not very useful for communication but lovely for earl grey",name:"TEAPOT"},sa={timeout:6e4,metricsCount:1e3},ta=1e4,ua={VALIDATED:"valid",PENDING:"pending",FAILED:"failed"};k();h(a,"message",X);var va={v:aa,name:ba,init:c,issueCall:e,isValidRequest:d,getVersion:function(){return aa},getName:function(){return ba},configure:b,getFrameData:f,inspect:function(){return{name:ba,version:aa,callsMade:ga,errorsFound:ha,pending:ia,defaults:sa,iFrameList:N(ja),activeFrames:g()}}};c();return va}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.xhr=lpTag.taglets.xhr||function(a){function b(){if(ka.lpAjax&&ka.lpAjax.addTransport){R=ka.lpAjax;try{R.addTransport(Y,la)}catch(a){}}O()}function c(a){if(a&&a.defaults)for(var c in a.defaults)a.defaults.hasOwnProperty(c)&&W.hasOwnProperty(c)&&(W[c]=a.defaults[c]);b();ja=!0}function d(a){a=g(a);var b=!1;if(a&&a.url&&"string"==typeof a.url&&$==j(a.url))if(a.method&&a.method.toLowerCase()!==T.GET.toLowerCase())b=!0;else{var c=da,d="";0!==a.url.indexOf("http")&&(a.url=i(a.url));try{a.query&&(d=s(a.query));a.data&&(d+=s(a.data))}catch(e){y("Error stringifying data",V.ERROR);b=!1}a.cache||(c-=10);a.url.length+1+d.length<=c&&(b=!0)}return ja&&b}function e(a){d(a)?p(a):a&&a.error&&x(a.error,ba,a.context)}function f(){return{name:Y,version:Z,callsMade:ea,errorsFound:fa,pending:ha.length,defaults:JSON.parse(v(W))}}function g(a){a.method=a.method||W.method;a.encoding=a.encoding||W.encoding;a.mimeType=a.mimeType||W.mimeType;a.retries=isNaN(a.retries)?W.retries:a.retries;a.timeout=isNaN(a.timeout)?W.timeout:a.timeout;a.XMLHTTPOverride="boolean"==typeof a.XMLHTTPOverride?a.XMLHTTPOverride:W.XMLHTTPOverride;a.cache="boolean"==typeof a.cache?a.cache:W.cache;a.asynch="boolean"==typeof a.asynch?a.asynch:W.asynch;if((a.method.toLowerCase()===T.PUT.toLocaleLowerCase()||a.method.toLowerCase()===T.DELETE.toLocaleLowerCase())&&a.XMLHTTPOverride){a.headers[_]=a.method;a.method=T.POST}return a}function h(a){var b=a.url.indexOf("__d=");b>-1&&(a.url=a.url.substr(0,b-1));if(!a.cache&&(a.method.toLowerCase()!==T.GET.toLowerCase()||a.url.length<=da-10)){a.url+=a.url.indexOf("?")>0?"&__d=":"?__d=";a.url+=Math.floor(1e5*Math.random())}}function i(a){var b=document.location.href.lastIndexOf("/")||document.location.href.lastIndexOf("?"),c=document.location.href.substr(0,b);a=c+"/"+a;return a}function j(b){var c,d=new RegExp(/(http{1}s{0,1}?:\/\/)([^\/\?]+)(\/?)/gi),e=null;c=0===b.indexOf("http")?d.exec(b):d.exec(a.location.href);c&&c.length>=3&&""!==c[2]&&(e=c[1].toLowerCase()+c[2].toLowerCase());return e}function k(a,b,c){b=b||{};b["Content-Type"]=l(b["Content-Type"]||W.mimeType,c.encoding);b.Accept=b.Accept||W.acceptHeader;b["X-Requested-With"]="XMLHttpRequest";if(b)for(var d in b)if(b.hasOwnProperty(d))try{a.setRequestHeader(d,b[d])}catch(e){}return a}function l(a,b){var c=a;(!c||""===c||c.indexOf("charset")<0)&&(c=(c||W.MIMETYPE)+"; charset="+(b||W.encoding));return c}function m(a){var b=ca?A(a):z(a);b.overrideMimeType&&b.overrideMimeType(a.mimeType);try{if(a.query){a.url=n(a.url,a.query);a.query=null}if(a.method===T.GET&&a.data){a.url=n(a.url,a.data);a.data=null}else"undefined"!=typeof a.data&&(a.data=u(a.data))}catch(c){r(a,b,!1,{responseCode:601,HTTPStatus:"Unable to service request",headers:"",body:{error:"unable to stringify data for requests"}});return!1}h(a);a.xhr=b;b.open(a.method,a.url,a.asynch);b=k(b,a.headers,a);o(a);b.send(a.data||null);Q||setTimeout(q,1e3);return!0}function n(a,b){var c;c=s(b);if(c){a+=a.indexOf("?")<0?"?":"&";a+=c}return a}function o(a){a.launchTime=new Date;ha.push(a);K()}function p(a){ga.push(a);w()}function q(){if(Q){clearTimeout(Q);Q=null}for(var a=new Date,b=[],c=0;c<ha.length;c++){var d=ha[c],e=a.valueOf()-d.launchTime.valueOf();if(e>d.timeout){r(d,d.xhr,!0);b.push(d)}}for(var f=0;f<b.length;f++){L(b[f]);b[f]=null}(ga.length>0||ha.length>0)&&(Q=setTimeout(q,1e3))}function r(a,b,c,d){J();a.launchTime&&M(a.launchTime.getTime(),a.url,a.method,d&&d.responseCode||408);c||L(a);t(a);if(c&&b)try{b.abort()}catch(e){y("Error when trying to abort request "+a.url,V.ERROR)}b&&B(b);if(a.retries>0&&!d){a.retries=a.retries-1;p(a)}else x(a.error,d||aa,a.context)}function s(a){var b="";if("string"==typeof a)b+=a;else{var c=!0;for(var d in a)if(a.hasOwnProperty(d)){var e;"object"==typeof a[d]?e=v(a[d]):"function"!=typeof a[d]&&(e=a[d]);if("undefined"!=typeof e){c||(b+="&");b+=encodeURIComponent(d)+"="+encodeURIComponent(e);c=!1}}}return b}function t(a){for(var b=["xhr"],c=0;c<b.length;c++){a[b[c]]=null;delete a[b[c]]}}function u(a){return"object"==typeof a?v(a):"string"==typeof a?a:""}function v(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function w(){for(;ha.length<6&&ga.length>0;)m(ga.shift())}function x(a,b,c){if(a&&"function"==typeof a)try{a.call(c,b)}catch(d){y(d.message,"error")}}function y(b,c){a.lpTag&&lpTag.log&&lpTag.log(b,c,Y)}function z(b){var c=new a.XMLHttpRequest;c.addEventListener(U.LOAD,function(){if(b&&!b.completed){H(this,b);b.completed=!0}else b=null});c.addEventListener(U.PROGRESS,function(){var a=C(this);a&&b&&b.progress&&x(b.progress,a,b.context)});c.addEventListener(U.ERROR,function(){if(b&&!b.completed){I(this,b);b.completed=!0}else b=null});c.addEventListener(U.READYSTATE,function(){if(this.readyState===X.COMPLETE)if(b&&!b.completed){H(this,b);b.completed=!0}else b=null});return c}function A(b){var c=new a.XMLHttpRequest;c[U.READYSTATE]=function(){if(!b.completed&&this.readyState===X.COMPLETE){H(this,b);b.completed=!0}};c[U.ERROR]=function(){I(this,b)};return c}function B(a){a[U.READYSTATE]=null;a[U.ERROR]=null;if(!ca){a[U.PROGRESS]=null;a[U.LOAD]=null}a=null}function C(a){var b,c;if(!a){y("No data from request",V.INFO);return{}}try{c=F(a);b={responseCode:E(a,"status")||404,HTTPStatus:E(a,"statusText"),body:E(a,"responseText","string")||E(a,"responseXML"),headers:c.headers,originalHeader:c.originalHeader}}catch(d){y(d.message,V.ERROR);return{}}if(D(b))try{b.body=JSON.parse(b.body)}catch(d){}b.responseCode=1223==b.responseCode?204:b.responseCode;if(b.responseCode>=12e3){b.internalCode=b.responseCode;b.responseCode=500}b.statusCode=b.responseCode;return b}function D(a){return a&&a.headers&&a.headers["Content-Type"]&&a.headers["Content-Type"].indexOf(S.JSON)>-1}function E(a,b,c){try{return c?typeof a[b]===c?a[b]:"":a[b]}catch(d){return""}}function F(a){var b,c={};try{b=a.getAllResponseHeaders()}catch(d){b=""}if(b)for(var e=b.split("\n"),f=0;f<e.length;f++)try{var g=e[f].split(":");if(g[0]){var h=g.length>2?g.slice(1).join(":"):g[1];c[G(g[0])]=G(h)}}catch(d){}return{originalHeader:b,headers:c}}function G(a){if(a&&"string"==typeof a){a=a.replace(/^[\s\r]*/,"");a=a.replace(/[\s\r]*$/g,"")}return a}function H(a,b){t(b);var c=C(a);b.launchTime&&M(b.launchTime.getTime(),b.url,b.method,c.responseCode);if(c){var d;if(c.responseCode>399)r(b,a,!1,c);else{L(b);d=b.success;x(d,c,b.context);B(a)}}w()}function I(a,b){r(b,a);w()}function J(){fa+=1}function K(){ea+=1}function L(a){for(var b=0;b<ha.length;b++)if(ha[b]===a){ha.splice(b,1);break}}function M(a,b,c,d){var e,f;if(a){f=(new Date).getTime();e=f-a;ia.push({rd:e,ts:a,url:b,method:c,statusCode:d});ia.length>=W.metricsCount&&N()}}function N(){var a;if(ka&&ka.lpAjax.publishMetrics&&ia.length>0){R=ka.lpAjax;a={tags:[{transport:Y}],metrics:ia};R.publishMetrics(a);ia.length=0}O()}function O(){P&&clearTimeout(P);P=setTimeout(N,W.metricsTimeout)}var P,Q,R,S={JSON:"application/json",JAVASCRIPT:"text/javascript",HTML:"text/html",XMLAPP:"application/xml",XMLTEXT:"text/xml",FORM:"application/x-www-form-urlencoded;"},T={GET:"GET",POST:"POST",PUT:"PUT",PATCH:"PATCH",DELETE:"DELETE"},U={PROGRESS:"progress",LOAD:"load",ERROR:"error",ABORT:"abort",READYSTATE:"readystatechange"},V={ERROR:"ERROR",DEBUG:"DEBUG",INFO:"INFO"},W={encoding:"UTF-8",method:T.GET,asynch:!0,timeout:3e4,mimeType:S.JSON,cache:!1,acceptHeader:"*/*",XMLHTTPOverride:!0,retries:2,metricsCount:100,metricsTimeout:6e4},X={UNSENT:0,OPENED:1,HEADERS_RECIEVED:2,LOADING:3,COMPLETE:4},Y="xhr",Z="1.1.8",$=j(document.location.href),_="X-HTTP-Method-Override",aa={responseCode:404,HTTPStatus:"bad request",body:{error:"Request timed out"},headers:""},ba={responseCode:600,HTTPStatus:"unable to service request",body:{error:"Transport - "+Y+" - unable to run request"},headers:""},ca=!a.addEventListener,da=2083,ea=0,fa=0,ga=[],ha=[],ia=[],ja=!0,ka=lpTag.taglets;if(ca){U.READYSTATE="on"+U.READYSTATE;U.ERROR="on"+U.ERROR}var la={init:b,name:Y,v:Z,configure:c,issueCall:e,isValidRequest:d,inspect:f};b();return la}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.LPWebSocketWrapper=lpTag.taglets.LPWebSocketWrapper||function(a){function b(){}function c(a){if(a){Q||"string"!=typeof a.server||0===a.server.indexOf("ws")&&(K=a.server);"function"==typeof a.created&&R.push({cb:a.created,context:a.context});"function"==typeof a.message&&S.push({cb:a.message,context:a.context});"function"==typeof a.closed&&T.push({cb:a.closed,context:a.context});"object"==typeof a.ping&&h(a.ping);if(K){for(var b in Y)Y.hasOwnProperty(b)&&typeof a[b]==typeof Y[b]&&(Y[b]=a[b]);return!!Q||m(Y)}}}function d(){var a=!1;if(H)a=Q;else{V=0;a=m()}return a}function e(){return Q}function f(a){try{if(e()){y();H.send(x(a))}else j("Socket not connected","send")}catch(b){j("unable to send request","send")}}function g(){clearTimeout(J);clearTimeout(I);K="";t();R.length=0;S.length=0;T.length=0;U.length=0}function h(a){if("object"==typeof a&&a.request){X.request=JSON.parse(x(a.request));O=!0;if(a.response)X.response=a.response;else if("object"==typeof a.keys&&"object"==typeof X.request&&"string"==typeof a.keys.request&&"string"==typeof a.keys.response){X.reqKey=a.keys.request;X.resKey=a.keys.response}"function"==typeof a.callback&&U.push({cb:a.callback});(X.response||X.reqKey&&X.resKey)&&(X.timeout=a.timeout||Y.pingTimeout);X.idleBeforePing=a.idleBeforePing||Y.idleBeforePing}}function i(a,b,c){if(window.lpTag&&lpTag.log){"string"==typeof a&&c&&(a=c+": "+a);lpTag.log(a,b,L)}}function j(a,b){i(a,Z.ERROR,b)}function k(){if(V>=Y.maxReconnectAttempt)v("cb",T,{state:"TERMINAL",code:503,message:"Socket terminal, will not reconnect"});else if(Y.autoReconnect&&K){J&&clearTimeout(J);J=setTimeout(function(){if(!m()){V+=1;k()}},l())}}function l(){var a;a=V<W[0].count?Y.reconnectTimeout||W[0].timeout:V<W[1].count?W[1].timeout:W[2].timeout;return a}function m(a){var b=!1;K=a&&a.server||K;if(!H&&K&&navigator.onLine===!0){try{H=new WebSocket(K)}catch(c){j("Exception creating WebSocket: "+c.message,"_createSocket");H=null}if(H&&H.readyState<=3){n();b=!0}}return b}function n(){if(H&&"function"!=typeof H.onopen){H.onopen=p;H.onclose=s;H.onerror=E;H.onmessage=q}}function o(){if(H){H.onopen=null;H.onclose=null;H.onerror=null;H.onmessage=null}}function p(a){Q=!0;V=0;v("cb",R,u(a)||{state:"OPEN",code:200})}function q(a){var b=!1;if(a)try{var c=r(a.data);P&&(b=D(c));y();b||v("cb",S,c)}catch(d){j("failed to process message","_socketMessage")}}function r(a){var b=a;try{b=JSON.parse(a)}catch(c){j("Unable to parse message","transformToJSON")}return b}function s(a,b){Q=!1;F();v("cb",T,u(a,b)||{state:"CLOSED",code:500});k()}function t(){Y.autoReconnect=!1;Q&&H.close();F()}function u(a,b){return a?{name:L,state:a.type,code:a.code,statusCode:a.code>1e3||b?500:200,reason:a.reason||"",domain:a.srcElement&&a.srcElement.url?a.srcElement.url:""}:null}function v(a,b,c){var d;if(b){d=b.constructor===Array?b:[b];for(var e=0;e<d.length;e++)w(d[e][a],c,d[e].context)}d=null}function w(a,b,c){if("function"==typeof a)try{a.call(c||null,b)}catch(d){j("Error executing callback","_runCallback")}}function x(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function y(){if(O&&!P){z();X.timeoutId=setTimeout(A,X.idleBeforePing)}}function z(){if(X.timeoutId){clearTimeout(X.timeoutId);X.timeoutId=null}}function A(){if(O&&!P){P=!0;f(C(),!0);X.timeout&&(I=setTimeout(B,X.timeout))}}function B(){P=!1;v("cb",U,{state:"TIMEOUT",code:404,message:"No Ping Response from Service"});X.failed=!0;delete X.timeoutId;y()}function C(){var a;if(X.request){a=JSON.parse(x(X.request));if(X.reqKey&&"object"==typeof a){X.lastKey="pingKey_"+Math.floor(99999999*Math.random());a[X.reqKey]=X.lastKey}}return a}function D(a){if(X.response||X.reqKey&&X.resKey){X.response?a===X.response&&(P=!1):"object"==typeof a&&a[X.resKey]===X.lastKey&&(P=!1);if(!P&&I){clearTimeout(I);I=null}if(X.failed){v("cb",U,{state:"RECOVERED",code:200,message:"Ping Response"});X.failed=!1}}return!P}function E(a){s(a,!0);V+=1}function F(){o();z();H=null}function G(){var a="WebSocket is not supported here.";j(a,"socketNotSupported");return a}var H,I,J,K,L="LPWebSocketWrapper",M="0.9.7",N="undefined"!=typeof window.WebSocket&&((""+window.WebSocket).indexOf("[native")>-1||(""+window.WebSocket).indexOf("WebSocketConstructor")>-1),O=!1,P=!1,Q=!1,R=[],S=[],T=[],U=[],V=0,W=[{count:5,timeout:2e3},{count:20,timeout:5e3},{timeout:1e4}],X={},Y={autoReconnect:!0,reconnectTimeout:2e3,maxReconnectAttempt:100,idleBeforePing:1e4,pingTimeout:3e4},Z={DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR"};c(a);return{name:L,v:M,init:b,dispose:g,supported:N,connected:e,configure:N?c:G,send:N?f:G,restartSocket:N?d:G}};window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.websocket2http=lpTag.taglets.websocket2http||function(a){function b(){K||(K=new lpTag.taglets.LPWebSocketWrapper);K.supported||k("WebSockets not supported","init")}function c(a){var b;if(!K.supported||!a||"object"!=typeof a)return!1;if("string"==typeof a.server){b={server:a.server,idleBeforePing:3e4,closed:u,created:a.created,message:t,autoReconnect:"boolean"!=typeof a.autoReconnect||a.autoReconnect,reconnectTimeout:isNaN(a.reconnectTimeout)?2e3:a.reconnectTimeout,maxReconnectAttempt:isNaN(a.maxReconnectAttempt)?30:a.maxReconnectAttempt};a&&!isNaN(a.timeout)&&(P.timeout=a.timeout);return K.configure(b)}h("No server set for WebSocket","configure")}function d(a){var b=!1;if(K.connected())for(var c=a&&a.constructor!==Array?[a]:a,d=0;d<c.length;d++){if(!l(c[d])){b=!1;break}b=!0}return b}function e(a){d(a)?m(a):a&&K.connected()?D("error",a,W):D("error",a,X)}function f(a){var b=!1,c=[];if(a){"string"==typeof a?c=[a]:a&&a.constructor===Array&&(c=a);for(var d=0;d<c.length;d++)if(T[c[d]]){B(T[c[d]]);b=!0}n(c)}return b}function g(b,c,d){if(a.lpTag&&lpTag.log){"string"==typeof b&&d&&(b=d+": "+b);lpTag.log(b,c,N)}}function h(a,b){g(a,O.ERROR,b)}function i(a,b){g(a,O.DEBUG,b)}function j(a,b){g(a,O.TRACE,b||"")}function k(a,b){g(a,O.INFO,b)}function l(a){return!(!a||"string"!=typeof a.url||0!==a.url.indexOf("http")||!r(a.url)||"function"!=typeof a.success)}function m(a){var b;Q+=1;try{b=p(a);K.send(b);L=(new Date).getTime()}catch(c){b&&o(b);h("Failed to run request, exc "+c.message,"_runRequest");R+=1}}function n(a){var b={cancelId:a};K.connected()&&K.send(b)}function o(a){D("error",a,V);for(var b=0;b<a.length;b++)B(a[b].name)}function p(a){for(var b=a&&a.constructor===Array?a:a?[a]:[],c=[],d=0;d<b.length;d++)c.push(q(b[d]));return c}function q(a){var b,c=E(),d=(new Date).getTime();b=I(a);b=H(b);b.name=c;a.launchTime=d;S[c]=a;return b}function r(a){if(!(U.length>0))return!0;var b,c=!1,d=/https{0,1}:\/\/([^\/|\s]+)/gi.exec(a);b=2===d.length?d[1]:"";if(b)for(var e=0;e<U.length;e++){c=s(b,U[e]);if(c)return c}}function s(a,b){var c=!0,d=a.split(".");if(d.length>2)for(var e=d.length-1,f=b.split("."),g=f.length-1;g>=0;g--){if(d[e]!==f[g]&&"*"!==f[g]){c=!1;break}if(!(e-1>0))break;e-=1}else c=!1;return c}function t(a){if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&b&&(S[b]?w(b,S[b],a[b]):"config"===b&&a[b].allowDomain?A(a[b].allowDomain):h("Callback not found for key:"+b+" response:"+JSON.stringify(a[b]),"_handleMessage"));else h("Message response not an object: "+a,"_handleMessage")}function u(a){D("error",S,X);h("Socket closed: "+JSON.stringify(a))}function v(a){"undefined"==typeof a.responseCode&&("undefined"!=typeof a.statusCode?a.responseCode=a.statusCode:"undefined"!=typeof a.HTTPStatus&&(a.responseCode=a.HTTPStatus));return a}function w(a,b,c){var d;if(c){c=v(c);if(c.responseCode<400||c.statusCode&&c.statusCode<400)d=b.success;else{d=b.error;R+=1}if(z(a)){"object"==typeof c&&(c.requestName=a);y(a,c.cancelId)}else B(a);j(x(b,c),"_runMessageResponse");C(d,c,b.context);i("Ran response for key: "+a,"_runMessageResponse")}}function x(a,b){var c={},d=(new Date).getTime();c[a.url]={duration:d-a.launchTime,request:I(a),response:I(b)};return c}function y(a,b){if(b&&S[a]){S[a].cancelId=b;T[b]=a}}function z(a){return S[a]&&S[a].persistent===!0}function A(a){U=a;U&&U.constructor===Array&&1===U.length&&"*"===U[0]&&(U.length=0);i("Allowed Domains: "+JSON.stringify(a),"_setAllowedDomains")}function B(a){S[a]=null;delete S[a]}function C(a,b,c){if("function"==typeof a)try{a.call(c||null,b)}catch(d){h("Error executing callback","_runCallback")}}function D(a,b,c){var d;if(b){d=b.constructor===Array?b:[b];for(var e=0;e<d.length;e++)C(d[e][a],I(c),d[e].context)}d=null}function E(){return"ws"+(Math.abs(Math.round(9999999999*Math.random()))+(new Date).getTime())}function F(a){var b="";if("string"==typeof a)b+=a;else{var c=!0;for(var d in a){var e;"object"==typeof a[d]?e=JSON.stringify(a[d]):"function"!=typeof a[d]&&(e=a[d]);if("undefined"!=typeof e){c||(b+="&");b+=encodeURIComponent(d)+"="+encodeURIComponent(e);c=!1}}}return b}function G(a,b){var c=F(b);if(c){a+=a.indexOf("?")<0?"?":"&";a+=c}return a}function H(a){a.method||(a.method="GET");isNaN(a.timeout)&&(a.timeout=P.timeout);a.caseSensitiveHeaders=a.caseSensitiveHeaders!==!1;if(a.query){a.url=G(a.url,a.query);a.query=null}return a}function I(a){try{return JSON.parse(J(a))}catch(b){h("Failed to clone object","_cloneSimpleObj");return new Error("Failed to clone object")}}function J(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}var K,L,M="0.9.4",N="websocket2http",O={DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR",TRACE:"TRACE"},P={timeout:3e4},Q=0,R=0,S={},T={},U=[],V={statusCode:400,responseCode:400,message:"Malformed/Bad request, unable to service it",name:"BADREQUEST"},W={statusCode:401,responseCode:401,message:"Batch(elor) WS can't service this request.",name:"FORBIDDEN"},X={statusCode:500,responseCode:500,message:"WebSocket is not connected",name:"NOCONNECTION"};b();var Y={init:b,configure:c,name:N,version:M,issueCall:e,cancelPersistentRequest:f,isValidRequest:d,inspect:function(){return{name:N,version:M,callsMade:Q,errorsFound:R}}};if(K&&K.supported&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(N,Y)}catch(Z){}return Y}(window);window.lpTag=window.lpTag||{};window.lpTag.transportSDK=window.lpTag.transportSDK||function(){function a(a){var b=!1,c=a&&a.siteId;if(c){m[c]||f(c,a.QA||i,d(c,a.services,a.callback));b=!0;h=c;if(a.conf)for(var e in a.conf)a.conf.hasOwnProperty(e)&&"function"!=typeof a.conf[e]&&(l[e]=a.conf[e])}else g(a.callback,{configured:!1,message:"No siteId found in configuration"});return b}function b(a){a.transportOrder=l.noWS?[n[0],n[2],n[3]]:[n[0],n[1],n[2],n[3]];return p.issueCall(a)}function c(a,b){var c;b=b||h;b&&m[b]&&(c=a?m[b].CSDS[a]:JSON.parse(JSON.stringify(m[b].CSDS)));return c}function d(a,b,c){return function(d){var f={site:a,services:b,configured:!0};if(!d){for(var h=m[a].CSDS,i={frames:[]},j=0;j<b.length;j++)h[b[j]]&&i.frames.push({url:"https://"+h[b[j]]+e(b[j]),maxReloadRetries:1e5});p.configureTransports({postmessage:i,websocket2http:{server:h.batchelor&&!l.noWS?"wss://"+h.batchelor+"/ws_api/batchelor":""}})}if(d){f.configured=!1;f.msg="Failed to get domain list for "+a}g(c,f)}}function e(a){var b=["agent","openPlatform","adminArea","mTag"];return b.indexOf(a)>-1?"/hcp/html/postmessage.min.html":"/postmessage/postmessage.min.html"}function f(a,b,c){var d=b?"https://hc1n.dev.lprnd.net/":"https://adminlogin.liveperson.net/",e="csdr/account/"+a+"/service/baseURI.lpCsds?version=1.0";o.jsonp.issueCall({url:d+e,success:function(b){var d,e=b&&b.ResultSet&&b.ResultSet.lpData&&b.ResultSet.lpData.baseURIs||[];if(e&&e.length>0){m[a]={CSDS:{}};for(var f=0;f<e.length;f++){d=e[f];m[a].CSDS[d.service]=d.baseURI}g(c)}},error:function(){g(c,!0)}})}function g(a,b){try{"function"==typeof a&&a(b)}catch(c){}}var h,i,j="0.0.1",k="transportSDK",l={},m={},n=["xhr","websocket2http","postmessage","jsonp"],o=lpTag.taglets,p=lpTag.taglets.lpAjax;return{name:k,version:j,configure:a,issueCall:b,getDomain:c}}();